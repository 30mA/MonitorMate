<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<link rel="icon" href="./images/favicon16.png" type="image/png">
	<link rel="stylesheet" href="./css/monitormate.css" type="text/css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="./config/config.php"></script>
	<script src="./js/monitormate.js"></script>
	<title>MonitorMate â€” Status</title>
</head>
<body>
	<div id="navbar">
		<ol id="toc">
			<li><a href="monitormate.html">Current Conditions</a></li>
			<li><a href="historical.html">Historical</a></li>
			<li class="current"><a href="status.html">Status</a></li>
		</ol>
		<h1 id="navtitle"></h1>
	</div>
	<div id="hubinfo">
	</div>
	<h1>Inverters</h1>
	<div id="inverters">None Found</div>
	
	<h1>Charge Controllers</h1>
	<div id="charge_controllers">None Found</div>

	<h1>Battery Monitor</h1>
	<div id="fndc">None Found</div>
	
	<script>

		$(document).ready(function() {

			// set the system name in the navbar		
			$('#navtitle').text(cfg_sysName);

			get_current_status();

			for (var device in json_status) {
				switch (json_status[device].device_id) {
					case FX_ID:
						if ($('#inverters').text() == "None Found") {
							$('#inverters').text('');
						}
						$('#inverters').append("<div class='status' style='display: inline-block;'><div id='"+device+"' class='status_content'>Inverter Found.</div></div>&nbsp;");
						$('#'+device).data('devAddress', FX_ID+':'+json_status[device].address);
						set_status(device, $('#'+device).data('devAddress'));
						break;
					case CC_ID:
						if ($('#charge_controllers').text() == "None Found") {
							$('#charge_controllers').text('');
						}
						$('#charge_controllers').append('<div class="status" style="display: inline-block;"><div id="'+device+'" class="status_content">Charge Controller Found.</div></div>&nbsp;');
						$('#'+device).data('devAddress', CC_ID+':'+json_status[device].address);
						set_status(device, $('#'+device).data('devAddress'));
						break;
					case FNDC_ID:
						if ($('#fndc').text() == "None Found") {
							$('#fndc').text('');
						}
						$('#fndc').append('<div class="status" style="display: inline-block;"><div id="'+device+'" class="status_content">FNDC Found.</div></div>&nbsp;');
						$('#'+device).data('devAddress', FNDC_ID+':'+json_status[device].address);
						set_status(device, $('#'+device).data('devAddress'));
						break;
				}
			}
					
			setInterval("refresh_data()", 10000);
			
		});

		function refresh_data() {
			get_current_status();
			for (address = 1; address <= 10; address++) {
				
				if ($('#device'+address).length > 0) {
					set_status('device'+address, $('#device'+address).data('devAddress'));
				}
				
			}

		}		

	</script>
</body>
</html>
